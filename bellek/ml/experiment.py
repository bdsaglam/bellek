# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/ml.experiment.ipynb.

# %% auto 0
__all__ = ['context_wandb', 'make_experiment_dir']

# %% ../../nbs/ml.experiment.ipynb 3
from contextlib import contextmanager
from pathlib import Path

# %% ../../nbs/ml.experiment.ipynb 4
@contextmanager
def context_wandb(entity, project, **kwargs):
    import wandb
    try:
        wandb_run = wandb.init(
            entity=entity,
            project=project,
            **kwargs
        )
        yield wandb_run
    finally:
        if wandb_run:
            wandb.finish()

# %% ../../nbs/ml.experiment.ipynb 5
def make_experiment_dir(root="./experiments", name=None):
    if name is None:
        from bellek.utils import generate_time_id
        name = generate_time_id()
    experiment_dir = Path(root) / name
    experiment_dir.mkdir(parents=True, exist_ok=True)
    return experiment_dir
